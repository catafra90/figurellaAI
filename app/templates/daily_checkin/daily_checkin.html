{% extends "base.html" %}

{% block content %}
<form method="POST" action="{{ url_for('daily_checkin.submit_report') }}">
  <div class="mt-6 space-y-6">

    <!-- Header with History Icon -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-bold figurella-pink">Daily Check-in</h2>
      <a href="{{ url_for('daily_checkin.report_history') }}" class="text-gray-500 hover:text-figurella" title="View History">
        <i class="bi bi-clock-history text-2xl"></i>
      </a>
    </div>

    <!-- Sales Section -->
    <div class="bg-white rounded-2xl shadow p-6">
      <h3 class="text-xl font-semibold mb-4">üí∞ Sales</h3>
      <div id="sales-section"></div>
      <button type="button" class="bg-figurella text-white px-4 py-2 rounded mt-2" onclick="addSaleRow()">+ Add Sale</button>
    </div>

    <!-- Leads Section -->
    <div class="bg-white rounded-2xl shadow p-6">
      <h3 class="text-xl font-semibold mb-4">üìù Leads</h3>
      <div id="leads-section"></div>
      <button type="button" class="bg-figurella text-white px-4 py-2 rounded mt-2" onclick="addLeadRow()">+ Add Lead</button>
    </div>

    <!-- Consultations Section -->
    <div class="bg-white rounded-2xl shadow p-6">
      <h3 class="text-xl font-semibold mb-4">üìÖ Consultations</h3>
      <div id="consultations-section"></div>
      <button type="button" class="bg-figurella text-white px-4 py-2 rounded mt-2" onclick="addConsultationRow()">+ Add Consultation</button>
    </div>

    <!-- Opportunities Section -->
    <div class="bg-white rounded-2xl shadow p-6">
      <h3 class="text-xl font-semibold mb-4">üí° Opportunities</h3>
      <div id="opportunities-section"></div>
      <button type="button" class="bg-figurella text-white px-4 py-2 rounded mt-2" onclick="addOpportunityRow()">+ Add Opportunity</button>
    </div>

    <!-- Attendances Section (no add button) -->
    <div class="bg-white rounded-2xl shadow p-6">
      <h3 class="text-xl font-semibold mb-4">üßç Attendances</h3>
      <div id="attendances-section"></div>
    </div>

    <!-- Submit Button -->
    <div class="flex justify-end">
      <button type="submit" class="bg-figurella text-white px-6 py-2 rounded-full shadow hover:bg-pink-700 transition">
        Submit Report
      </button>
    </div>
  </div>
</form>

<script>
function templateRow(fields) {
  return '<div class="grid grid-cols-' + fields.length + ' gap-2 mb-2">' +
    fields.map(f => '<input name="' + f + '[]" class="border p-2 rounded w-full" placeholder="' + f.replace(/_/g, ' ') + '">').join('') +
    '</div>';
}

function addSaleRow() {
  document.getElementById('sales-section').innerHTML += templateRow(['client_name', 'package_sold', 'revenue']);
}
function addLeadRow() {
  document.getElementById('leads-section').innerHTML += templateRow(['lead_name', 'lead_date', 'lead_source']);
}
function addConsultationRow() {
  document.getElementById('consultations-section').innerHTML += templateRow(['consult_client', 'consult_outcome', 'consult_source']);
}
function addOpportunityRow() {
  document.getElementById('opportunities-section').innerHTML += templateRow(['opp_name', 'opp_provider', 'opp_description']);
}
function addAttendanceRow() {
  document.getElementById('attendances-section').innerHTML += templateRow(['att_attended', 'att_no_show']);
}

// Load 1 row per section by default
window.onload = function () {
  addSaleRow();
  addLeadRow();
  addConsultationRow();
  addOpportunityRow();
  addAttendanceRow();
};
</script>
{% endblock %}
